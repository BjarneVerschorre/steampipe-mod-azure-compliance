benchmark "rbi_itf_nbfc_v2016_patch_vulnerability_and_change_management" {
  title = "Patch/Vulnerability & Change Management"
  children = [
    benchmark.rbi_itf_nbfc_v2016_patch_vulnerability_and_change_management_7
  ]

  tags = local.rbi_itf_nbfc_v2016_common_tags
}

benchmark "rbi_itf_nbfc_v2016_patch_vulnerability_and_change_management_7" {
  title = "Patch/Vulnerability & Change Management-7"
  children = [
    benchmark.rbi_itf_nbfc_v2016_patch_vulnerability_and_change_management_7_1,
    benchmark.rbi_itf_nbfc_v2016_patch_vulnerability_and_change_management_7_2,
    benchmark.rbi_itf_nbfc_v2016_patch_vulnerability_and_change_management_7_6,
    benchmark.rbi_itf_nbfc_v2016_patch_vulnerability_and_change_management_7_7
  ]

  tags = local.rbi_itf_nbfc_v2016_common_tags
}

benchmark "rbi_itf_nbfc_v2016_patch_vulnerability_and_change_management_7_1" {
  title = "Patch/Vulnerability & Change Management-7.1"
  children = [
    control.compute_vm_system_updates_installed,
    control.compute_vm_vulnerability_assessment_solution_enabled,
    control.mssql_managed_instance_vulnerability_assessment_enabled,
    control.sql_database_vulnerability_findings_resolved,
    control.sql_server_and_databases_va_enabled
  ]
  tags = local.rbi_itf_nbfc_v2016_common_tags
}

benchmark "rbi_itf_nbfc_v2016_patch_vulnerability_and_change_management_7_2" {
  title = "Patch/Vulnerability & Change Management-7.2"
  children = [
    control.compute_vm_system_updates_installed,
    control.compute_vm_vulnerability_assessment_solution_enabled,
    control.mssql_managed_instance_vulnerability_assessment_enabled,
    control.sql_database_vulnerability_findings_resolved,
    control.sql_server_and_databases_va_enabled
  ]
  tags = local.rbi_itf_nbfc_v2016_common_tags
}

benchmark "rbi_itf_nbfc_v2016_patch_vulnerability_and_change_management_7_6" {
  title = "Patch/Vulnerability & Change Management-7.6"
  children = [
    control.compute_vm_system_updates_installed,
    control.securitycenter_azure_defender_on_for_appservice,
    control.securitycenter_azure_defender_on_for_containers,
    control.securitycenter_azure_defender_on_for_keyvault,
    control.securitycenter_azure_defender_on_for_opensource_relational_db,
    control.securitycenter_azure_defender_on_for_resource_manager,
    control.securitycenter_azure_defender_on_for_server,
    control.securitycenter_azure_defender_on_for_sqldb,
    control.securitycenter_azure_defender_on_for_sqlservervm,
    control.securitycenter_azure_defender_on_for_storage,
    control.sql_database_vulnerability_findings_resolved,
    control.sql_server_azure_defender_enabled
  ]
  tags = local.rbi_itf_nbfc_v2016_common_tags
}

benchmark "rbi_itf_nbfc_v2016_patch_vulnerability_and_change_management_7_7" {
  title = "Patch/Vulnerability & Change Management-7.7"
  children = [
    control.apimanagement_service_with_virtual_network,
    control.app_configuration_private_link_used,
    control.compute_vm_ssh_key_authentication_linux,
    control.container_registry_restrict_public_access,
    control.container_registry_uses_private_link,
    control.eventgrid_domain_private_link_used,
    control.eventgrid_topic_private_link_used,
    control.keyvault_firewall_enabled,
    control.keyvault_vault_private_link_used,
    control.kubernetes_cluster_authorized_ip_range_defined,
    control.mariadb_server_private_link_used,
    control.mariadb_server_public_network_access_disabled,
    control.mysql_server_private_link_used,
    control.mysql_server_public_network_access_disabled,
    control.postgres_server_private_link_used,
    control.postgresql_server_public_network_access_disabled,
    control.spring_cloud_service_network_injection_enabled,
    control.sql_db_public_network_access_disabled,
    control.sql_server_uses_private_link,
    control.storage_account_block_public_access,
    control.storage_account_default_network_access_rule_denied,
    control.storage_account_restrict_network_access,
    control.storage_account_uses_private_link
  ]
  tags = local.rbi_itf_nbfc_v2016_common_tags
}